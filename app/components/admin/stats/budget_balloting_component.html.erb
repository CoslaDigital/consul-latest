<%# app/components/admin/stats/budget_balloting_component.html.erb %>
<% include_stat_graphs_javascript %>

<%= back_link_to budgets_admin_stats_path %>

<h2><%= budget.name %> - <%= t("admin.stats.budget_balloting.title") %></h2>

<div class="stats">
  <div class="row stats-numbers">
    <div class="small-12 medium-3 column">
      <p class="featured">
        <%= t("admin.stats.budget_balloting.vote_count") %>
        <br>
        <span id="total_votes_count" class="number">
          <%= vote_count %>
        </span>
      </p>
    </div>

    <div class="small-12 medium-6 column end">
      <p>
        <%= t("admin.stats.budget_balloting.participant_count") %>
        <br>
        <span id="total_participants_count" class="number">
          <%= user_count %>
        </span>
      </p>
    </div>
  </div>
</div>

<div class="stats-group">
  <table class="investment-projects-summary">
    <thead>
    <tr>
      <th colspan="2"><%= t("admin.stats.budget_balloting.votes_per_heading") %></th>
    </tr>
    </thead>
    <tbody>
    <% vote_count_by_heading.each do |heading_name, count| %>
      <tr>
        <td class="name"><%= heading_name %></td>
        <td class="name"><%= number_with_delimiter count %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<div class="stats-group">
  <table class="investment-projects-summary user-count-by-heading">
    <thead>
    <tr>
      <th colspan="2"><%= t("admin.stats.budget_balloting.participants_per_district") %></th>
    </tr>
    </thead>
    <tbody>
    <% user_count_by_heading.each do |heading_name, count| %>
      <tr>
        <td class="name"><%= heading_name %></td>
        <td class="name"><%= number_with_delimiter count %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<%# Geographic Summary Section %>
<div id="location_summary_section" class="stats-group">
  <h3 class="section-title"><%= t("stats.budgets.participation_density_view") %></h3>

  <%= render "admin/stats/precision_filter",
             url: url_for(controller: "/admin/stats", action: "budget_balloting"),
             precision: precision %>

  <%# DRY PARTIAL 2: The Data Table %>
  <%= render "admin/stats/audit_cluster_table", clusters: cluster_summary %>
</div>

<%# The Map %>
<section class="voter-map-section stats-group">
  <h3 class="section-title">Voter Density Map</h3>
  <div class="budgets-map">
    <%= render_map(nil,
                   investments_coordinates: voter_coordinates,
                   geozones_data: geozones_data) %>
  </div>
</section>
